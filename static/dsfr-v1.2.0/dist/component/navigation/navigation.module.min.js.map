{"version":3,"file":"navigation.module.min.js","sources":["../../../.config/config.js","../../../src/core/api.js","../../../src/component/navigation/script/navigation/navigation-selector.js","../../../src/component/navigation/script/navigation/navigation-item.js","../../../src/component/navigation/script/navigation/navigation-mouse-position.js","../../../src/component/navigation/script/navigation/navigation.js","../../../src/component/navigation/index.js","../../../src/component/navigation/main.js"],"sourcesContent":["const config = {\r\n  prefix: 'fr',\r\n  namespace: 'dsfr',\r\n  organisation: '@gouvfr',\r\n  version: '1.2.0'\r\n};\r\n\r\nexport default config;\r\n","import config from './config.js';\nconst api = window[config.namespace];\nexport default api;\n","import api from '../../api.js';\n\nexport const NavigationSelector = {\n  NAVIGATION: api.ns.selector('nav'),\n  COLLAPSE: `${api.ns.selector('nav__item')} > ${api.ns.selector('collapse')}`,\n  ITEM: api.ns.selector('nav__item'),\n  ITEM_RIGHT: api.ns('nav__item--align-right'),\n  MENU: api.ns.selector('menu')\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\n\nclass NavigationItem extends api.core.Instance {\n  constructor () {\n    super();\n    this._isRightAligned = false;\n  }\n\n  static get instanceClassName () {\n    return 'NavigationItem';\n  }\n\n  init () {\n    this.addAscent(api.core.DisclosureEmission.ADDED, this.calculate.bind(this));\n    this.addAscent(api.core.DisclosureEmission.REMOVED, this.calculate.bind(this));\n    this.isResizing = true;\n    this.calculate();\n  }\n\n  resize () {\n    this.calculate();\n  }\n\n  calculate () {\n    const collapse = this.element.getDescendantInstances(api.core.Collapse.instanceClassName, null, true)[0];\n    if (collapse && this.isBreakpoint(api.core.Breakpoints.LG) && collapse.element.node.matches(NavigationSelector.MENU)) {\n      const right = this.element.node.parentElement.getBoundingClientRect().right;\n      const width = collapse.element.node.getBoundingClientRect().width;\n      const left = this.element.node.getBoundingClientRect().left;\n      this.isRightAligned = left + width > right;\n    } else this.isRightAligned = false;\n  }\n\n  get isRightAligned () {\n    return this._isRightAligned;\n  }\n\n  set isRightAligned (value) {\n    if (this._isRightAligned === value) return;\n    this._isRightAligned = value;\n    if (value) api.addClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n    else api.removeClass(this.element.node, NavigationSelector.ITEM_RIGHT);\n  }\n}\n\nexport { NavigationItem };\n","export const NavigationMousePosition = {\n  NONE: -1,\n  INSIDE: 0,\n  OUTSIDE: 1\n};\n","import api from '../../api.js';\nimport { NavigationSelector } from './navigation-selector.js';\nimport { NavigationMousePosition } from './navigation-mouse-position.js';\n\nclass Navigation extends api.core.CollapsesGroup {\n  static get instanceClassName () {\n    return 'Navigation';\n  }\n\n  init () {\n    super.init();\n    this.clicked = false;\n    this.out = false;\n    this.listen('focusout', this.focusOut.bind(this));\n    this.listen('mousedown', this.down.bind(this));\n  }\n\n  validate (member) {\n    return member.element.node.matches(NavigationSelector.COLLAPSE);\n  }\n\n  down (e) {\n    if (!this.isBreakpoint(api.core.Breakpoints.LG) || this.index === -1 || !this.current) return;\n    this.position = this.current.element.node.contains(e.target) ? NavigationMousePosition.INSIDE : NavigationMousePosition.OUTSIDE;\n    this.request(this.getPosition.bind(this));\n  }\n\n  focusOut (e) {\n    if (!this.isBreakpoint(api.core.Breakpoints.LG)) return;\n    this.out = true;\n    this.request(this.getPosition.bind(this));\n  }\n\n  getPosition () {\n    if (this.out) {\n      switch (this.position) {\n        case NavigationMousePosition.OUTSIDE:\n          this.index = -1;\n          break;\n\n        case NavigationMousePosition.INSIDE:\n          if (this.current) this.current.focus();\n          break;\n\n        default:\n          if (this.index > -1 && !this.current.hasFocus) this.index = -1;\n      }\n    }\n    this.position = NavigationMousePosition.NONE;\n    this.out = false;\n  }\n\n  get index () { return super.index; }\n\n  set index (value) {\n    if (value === -1 && this.current !== null && this.current.hasFocus) this.current.focus();\n    super.index = value;\n  }\n}\n\nexport { Navigation };\n","import api from './api.js';\nimport { NavigationItem } from './script/navigation/navigation-item.js';\nimport { Navigation } from './script/navigation/navigation.js';\nimport { NavigationSelector } from './script/navigation/navigation-selector.js';\nimport { NavigationMousePosition } from './script/navigation/navigation-mouse-position.js';\n\napi.navigation = {\n  Navigation: Navigation,\n  NavigationItem: NavigationItem,\n  NavigationMousePosition: NavigationMousePosition,\n  NavigationSelector: NavigationSelector\n};\n\nexport default api;\n","import api from './index.js';\n\napi.register(api.navigation.NavigationSelector.NAVIGATION, api.navigation.Navigation);\napi.register(api.navigation.NavigationSelector.ITEM, api.navigation.NavigationItem);\n\nexport default api;\n"],"names":["api","window","NavigationSelector","NAVIGATION","ns","selector","COLLAPSE","ITEM","ITEM_RIGHT","MENU","NavigationItem","core","Instance","[object Object]","super","this","_isRightAligned","instanceClassName","addAscent","DisclosureEmission","ADDED","calculate","bind","REMOVED","isResizing","collapse","element","getDescendantInstances","Collapse","isBreakpoint","Breakpoints","LG","node","matches","right","parentElement","getBoundingClientRect","width","left","isRightAligned","value","addClass","removeClass","NavigationMousePosition","NONE","INSIDE","OUTSIDE","Navigation","CollapsesGroup","init","clicked","out","listen","focusOut","down","member","e","index","current","position","contains","target","request","getPosition","focus","hasFocus","navigation","register"],"mappings":";AAAA,MCCMA,EAAMC,OAAuB,KCCtBC,EAAqB,CAChCC,WAAYH,EAAII,GAAGC,SAAS,OAC5BC,SAAU,GAAGN,EAAII,GAAGC,SAAS,kBAAkBL,EAAII,GAAGC,SAAS,cAC/DE,KAAMP,EAAII,GAAGC,SAAS,aACtBG,WAAYR,EAAII,GAAG,0BACnBK,KAAMT,EAAII,GAAGC,SAAS,SCJxB,MAAMK,UAAuBV,EAAIW,KAAKC,SACpCC,cACEC,QACAC,KAAKC,iBAAkB,EAGzBC,+BACE,MAAO,iBAGTJ,OACEE,KAAKG,UAAUlB,EAAIW,KAAKQ,mBAAmBC,MAAOL,KAAKM,UAAUC,KAAKP,OACtEA,KAAKG,UAAUlB,EAAIW,KAAKQ,mBAAmBI,QAASR,KAAKM,UAAUC,KAAKP,OACxEA,KAAKS,YAAa,EAClBT,KAAKM,YAGPR,SACEE,KAAKM,YAGPR,YACE,MAAMY,EAAWV,KAAKW,QAAQC,uBAAuB3B,EAAIW,KAAKiB,SAASX,kBAAmB,MAAM,GAAM,GACtG,GAAIQ,GAAYV,KAAKc,aAAa7B,EAAIW,KAAKmB,YAAYC,KAAON,EAASC,QAAQM,KAAKC,QAAQ/B,EAAmBO,MAAO,CACpH,MAAMyB,EAAQnB,KAAKW,QAAQM,KAAKG,cAAcC,wBAAwBF,MAChEG,EAAQZ,EAASC,QAAQM,KAAKI,wBAAwBC,MACtDC,EAAOvB,KAAKW,QAAQM,KAAKI,wBAAwBE,KACvDvB,KAAKwB,eAAiBD,EAAOD,EAAQH,OAChCnB,KAAKwB,gBAAiB,EAG/BA,qBACE,OAAOxB,KAAKC,gBAGduB,mBAAoBC,GACdzB,KAAKC,kBAAoBwB,IAC7BzB,KAAKC,gBAAkBwB,EACnBA,EAAOxC,EAAIyC,SAAS1B,KAAKW,QAAQM,KAAM9B,EAAmBM,YACzDR,EAAI0C,YAAY3B,KAAKW,QAAQM,KAAM9B,EAAmBM,cC1CxD,MAAMmC,EAA0B,CACrCC,MAAO,EACPC,OAAQ,EACRC,QAAS,GCCX,MAAMC,UAAmB/C,EAAIW,KAAKqC,eAChC/B,+BACE,MAAO,aAGTJ,OACEC,MAAMmC,OACNlC,KAAKmC,SAAU,EACfnC,KAAKoC,KAAM,EACXpC,KAAKqC,OAAO,WAAYrC,KAAKsC,SAAS/B,KAAKP,OAC3CA,KAAKqC,OAAO,YAAarC,KAAKuC,KAAKhC,KAAKP,OAG1CF,SAAU0C,GACR,OAAOA,EAAO7B,QAAQM,KAAKC,QAAQ/B,EAAmBI,UAGxDO,KAAM2C,GACCzC,KAAKc,aAAa7B,EAAIW,KAAKmB,YAAYC,MAAuB,IAAhBhB,KAAK0C,OAAiB1C,KAAK2C,UAC9E3C,KAAK4C,SAAW5C,KAAK2C,QAAQhC,QAAQM,KAAK4B,SAASJ,EAAEK,QAAUlB,EAAwBE,OAASF,EAAwBG,QACxH/B,KAAK+C,QAAQ/C,KAAKgD,YAAYzC,KAAKP,QAGrCF,SAAU2C,GACHzC,KAAKc,aAAa7B,EAAIW,KAAKmB,YAAYC,MAC5ChB,KAAKoC,KAAM,EACXpC,KAAK+C,QAAQ/C,KAAKgD,YAAYzC,KAAKP,QAGrCF,cACE,GAAIE,KAAKoC,IACP,OAAQpC,KAAK4C,UACX,KAAKhB,EAAwBG,QAC3B/B,KAAK0C,OAAS,EACd,MAEF,KAAKd,EAAwBE,OACvB9B,KAAK2C,SAAS3C,KAAK2C,QAAQM,QAC/B,MAEF,QACMjD,KAAK0C,OAAS,IAAM1C,KAAK2C,QAAQO,WAAUlD,KAAK0C,OAAS,GAGnE1C,KAAK4C,SAAWhB,EAAwBC,KACxC7B,KAAKoC,KAAM,EAGbM,YAAe,OAAO3C,MAAM2C,MAE5BA,UAAWjB,IACM,IAAXA,GAAiC,OAAjBzB,KAAK2C,SAAoB3C,KAAK2C,QAAQO,UAAUlD,KAAK2C,QAAQM,QACjFlD,MAAM2C,MAAQjB,GClDlBxC,EAAIkE,WAAa,CACfnB,WAAYA,EACZrC,eAAgBA,EAChBiC,wBAAyBA,EACzBzC,mBAAoBA,GCRtBF,EAAImE,SAASnE,EAAIkE,WAAWhE,mBAAmBC,WAAYH,EAAIkE,WAAWnB,YAC1E/C,EAAImE,SAASnE,EAAIkE,WAAWhE,mBAAmBK,KAAMP,EAAIkE,WAAWxD"}